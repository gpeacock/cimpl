# Language Bindings for cimpl-uuid

This directory contains reference implementations of language bindings for the UUID library, demonstrating what can be generated from the C API.

## Directory Structure

```
bindings/
├── c/              - Reference C example
├── python/         - Python ctypes bindings
├── nodejs/         - Node.js Koffi bindings
└── lua/            - LuaJIT FFI bindings
```

## Purpose

These bindings serve **two purposes**:

1. **Reference Implementations** - They demonstrate the expected quality and structure of bindings that should be generated from the C header file (`include/cimple_uuid.h`).

2. **Test Suite** - They verify that the C API is correctly exposed and that the `cimpl` patterns work across different FFI technologies.

## Philosophy: Reference vs. AI-Generated

The bindings here are **maintained reference implementations**. They show what an AI or code generator *should* produce when given the C header file.

For **true AI generation testing**, we recommend:

1. Create an `.ai-generated/` directory (gitignored)
2. Provide an AI model with just the C header
3. Compare the generated output with these references
4. Iterate on the header documentation to improve AI output

## What Makes These "Good" Bindings?

Each binding demonstrates:

- ✅ **Language-idiomatic API** - Not just raw FFI calls
- ✅ **Custom exception/error classes** - Based on C error codes
- ✅ **Automatic memory management** - No manual `free()` calls
- ✅ **Type safety** - Where the language supports it
- ✅ **Documentation** - Docstrings, comments, examples

## Testing All Bindings

From the `uuid-example` root:

```bash
# C
make run-c

# Python
cd bindings/python && python3 test.py

# Node.js
cd bindings/nodejs && npm test

# Lua
cd bindings/lua && luajit test.lua
```

## How We Generated These

These bindings were created **manually with AI assistance**, providing:

1. The C header file (`include/cimple_uuid.h`)
2. A prompt describing the desired API style
3. Iterative refinement of both the C header documentation and the generated code

The goal of `cimpl` is to make the C header so clear and well-documented that step (3) becomes unnecessary.

## Adding More Languages

To add a new language binding:

1. Create `bindings/<language>/`
2. Generate bindings from `include/cimple_uuid.h`
3. Create a test suite
4. Add a README.md explaining the approach
5. Update this file

Popular candidates:
- Ruby (fiddle)
- Go (cgo)
- C# (P/Invoke)
- Swift (C interop)
- Zig (C integration)

## Status

| Language | Status | FFI Technology | Maintained |
|----------|--------|----------------|------------|
| C | ✅ Reference | Native | Yes |
| Python | ✅ Reference | ctypes | Yes |
| Node.js | ✅ Reference | Koffi | Yes |
| Lua | ✅ Reference | LuaJIT FFI | Yes |

## The `cimpl` Philosophy

The bindings here prove the **three-stage pipeline**:

1. **Rust** (safe, using `cimpl`) → 
2. **C API** (simple, generated by `cbindgen`) → 
3. **Target Language** (AI-generated from C header)

The C API is the **stable interface**. Language-specific FFI technologies can change (as we saw with `ffi-napi` → `koffi`), but the C API remains constant.
