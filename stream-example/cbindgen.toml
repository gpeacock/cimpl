language = "C"
include_guard = "CIMPL_STREAM_H"
documentation = true
documentation_style = "doxy"
autogen_warning = "/* Warning: This file is auto-generated by cbindgen. Don't modify manually. */"
namespace = "cimpl"

[export]
# Export all types by default
include = [
    "CimplStreamContext",
    "CimplSeekMode",
    "CimplStreamError",
    "CimplReadCallback",
    "CimplSeekCallback",
    "CimplWriteCallback",
    "CimplFlushCallback",
    "CimplStream",
]

[export.rename]
"CimplStreamContext" = "CimplStreamContext"
"CimplSeekMode" = "CimplSeekMode"
"CimplStream" = "CimplStream"

# Add a helpful trailer with cimpl_free declaration
after_includes = """
/**
 * @file cimpl_stream.h
 * @brief CimplStream - A callback-based stream interface for bridging C and Rust I/O
 *
 * This library provides a stream abstraction that allows C code to implement
 * Read, Write, and Seek operations through callbacks, which are then usable
 * by Rust code as standard Rust I/O traits.
 *
 * ## Memory Management
 * All pointers returned by this library must be freed with cimpl_free() when done.
 * Since the base cimpl library is statically linked into libcimpl_stream, the
 * cimpl_free() function is available when you link against libcimpl_stream.
 *
 * Declare it in your C code as:
 * @code{.c}
 * extern int32_t cimpl_free(void* ptr);
 * @endcode
 *
 * ## Error Handling  
 * Functions return error codes:
 * - NULL pointers indicate allocation/creation failure
 * - -1 indicates an error for integer-returning functions
 * - 0 indicates success for integer-returning functions
 *
 * Use cimpl_stream_last_error() to get detailed error messages.
 *
 * @example
 * @code{.c}
 * extern int32_t cimpl_free(void* ptr);
 *
 * // Implement callbacks for your stream
 * isize my_read(CimplStreamContext* ctx, uint8_t* data, size_t len) {
 *     // Read from your native stream
 *     return bytes_read;
 * }
 * 
 * // Create the stream
 * CimplStream* stream = cimpl_stream_new(
 *     context, my_read, my_seek, my_write, my_flush
 * );
 * 
 * // Use the stream
 * uint8_t buffer[1024];
 * isize bytes = cimpl_stream_read(stream, buffer, sizeof(buffer));
 * 
 * // Clean up
 * cimpl_free(stream);
 * @endcode
 */
"""

[enum]
# Prefix enum variants with enum name to avoid C namespace collisions
rename_variants = "ScreamingSnakeCase"
prefix_with_name = true
