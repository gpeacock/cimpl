# Reorganize language bindings structure

## Summary

Reorganized the `uuid-example` directory structure to clarify the purpose of language bindings as **reference implementations** rather than production code. This change supports the core `cimpl` philosophy: generate language bindings from well-documented C headers.

## Changes

### Directory Structure

```
uuid-example/
├── bindings/
│   ├── README.md                    # Overview and philosophy
│   ├── c/
│   │   ├── README.md               # C example documentation
│   │   └── example.c               # Moved from root
│   ├── python/
│   │   ├── README.md               # Python bindings documentation
│   │   ├── uuid_bindings.py        # Renamed from uuid_py.py
│   │   └── test.py                 # Renamed from test_uuid_py.py
│   ├── nodejs/
│   │   ├── README.md               # Node.js bindings documentation
│   │   ├── uuid_bindings.js        # Renamed from uuid_koffi.js
│   │   ├── test.js                 # Renamed from test_uuid_koffi.js
│   │   ├── package.json            # Moved from root
│   │   ├── node_modules/           # Moved from root
│   │   ├── uuid_ffi-napi.js.deprecated
│   │   └── test_ffi-napi.js.deprecated
│   └── lua/
│       ├── README.md               # Lua bindings documentation
│       ├── uuid_bindings.lua       # Renamed from uuid.lua
│       └── test.lua                # Renamed from test_uuid.lua
├── AI_GENERATION_GUIDE.md          # NEW: Guide for testing AI generation
├── BINDING_ORGANIZATION.md         # NEW: Reorganization details
├── STATUS.md                       # NEW: Status report
└── test_all.sh                     # NEW: Test runner for all bindings
```

### Core Changes

1. **Consistent Naming**
   - All bindings: `uuid_bindings.*`
   - All tests: `test.*`
   - Directory provides language context

2. **Path Updates**
   - Library paths: `../../target/release/`
   - Test imports updated to new filenames
   - Makefile references new C path

3. **Documentation**
   - Each binding has dedicated README
   - Top-level `bindings/README.md` explains philosophy
   - `AI_GENERATION_GUIDE.md` for testing AI generation
   - `BINDING_ORGANIZATION.md` documents the reorganization

4. **Build System**
   - `.gitignore`: Added `.ai-generated/` and Python cache
   - `test_all.sh`: Test runner for all bindings

### Bug Fixes

Fixed `ok_or_return!` macro to support both `ERROR_MAPPER` and `@local` variants:

```rust
macro_rules! ok_or_return {
    // For results using ERROR_MAPPER (public API)
    ($result:expr, $transform:expr, $err_val:expr) => { ... };
    
    // For cimple Error type results (internal use)
    (@local $result:expr, $transform:expr, $err_val:expr) => { ... };
}
```

## Testing

All bindings tested and working:

```bash
✅ C example:        make run-c
✅ Python bindings:  cd bindings/python && python3 test.py
✅ Node.js bindings: cd bindings/nodejs && npm test
✅ Lua bindings:     cd bindings/lua && luajit test.lua
✅ All bindings:     ./test_all.sh
```

## Philosophy

The reorganization clarifies that the bindings are:

1. **Reference Implementations** - Show expected quality and structure
2. **Test Suite** - Verify C API correctness across languages
3. **Templates** - For AI-generated bindings
4. **Not Production Packages** - Users should generate from C header

This supports the three-stage pipeline:
1. **Rust** (safe, using `cimpl`)
2. **C API** (simple, generated by `cbindgen`)
3. **Target Language** (AI-generated from C header)

## Migration

**No breaking changes** to core API:
- C header unchanged
- Library files unchanged
- Build process unchanged

Only binding file locations changed (reference implementations, not published packages).

## Files Changed

### Created
- `bindings/README.md`
- `bindings/{c,python,nodejs,lua}/README.md`
- `AI_GENERATION_GUIDE.md`
- `BINDING_ORGANIZATION.md`
- `STATUS.md`
- `test_all.sh`

### Modified
- `README.md` (updated bindings section)
- `Makefile` (updated C example path)
- `bindings/nodejs/package.json` (updated test script)
- `.gitignore` (added `.ai-generated/` and Python cache)
- `src/macros.rs` (fixed `ok_or_return!` macro)

### Moved/Renamed
- `example.c` → `bindings/c/example.c`
- `uuid_py.py` → `bindings/python/uuid_bindings.py`
- `test_uuid_py.py` → `bindings/python/test.py`
- `uuid_koffi.js` → `bindings/nodejs/uuid_bindings.js`
- `test_uuid_koffi.js` → `bindings/nodejs/test.js`
- `uuid.lua` → `bindings/lua/uuid_bindings.lua`
- `test_uuid.lua` → `bindings/lua/test.lua`
- `package.json` → `bindings/nodejs/package.json`
- `node_modules/` → `bindings/nodejs/node_modules/`
- `uuid.js` → `bindings/nodejs/uuid_ffi-napi.js.deprecated`
- `test_uuid.js` → `bindings/nodejs/test_ffi-napi.js.deprecated`

## Benefits

1. **Clarity** - Purpose clear from location and documentation
2. **Consistency** - All bindings follow same structure
3. **Maintainability** - Each binding has dedicated README
4. **Testability** - Clear separation of reference vs. AI-generated
5. **Discoverability** - Easy to find examples for your language

## Next Steps

Users can now:
1. Use bindings as reference
2. Test AI generation with provided guide
3. Improve C header based on AI results
4. Add new languages following established patterns
